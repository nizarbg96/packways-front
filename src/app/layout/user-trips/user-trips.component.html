<ngx-spinner class="myspinner" bdColor = "rgba(255,255,255,0.8)" fullScreen="true" size = "large" color = "#000000" type = "ball-square-clockwise-spin">
  <p style="color: black; font-size: large; margin-top: 100px; height: 100vh !important"> Veuillez patienter...</p>
</ngx-spinner>
<div [@routerTransition]>
  <app-page-header [heading]="'Gestion des colis'" [icon]="'fa-table'"></app-page-header>
  <div class="row">
    <!-- &nbsp;&nbsp;&nbsp;&nbsp; <h3>Gestion de colis</h3> -->
    <div class="col col-xl-12 col-lg-12">
      <div class="card mb-3">
        <div class="card-header">
          <div class="row">
            <div class="col-xl-12 text-xs-center">
              <div class="row">
                <div class="col-xl-12 text-xs-center">
                  <div class="row">
                    <!-- <div *ngIf="isVisible" right class="col-xl-4 text-xs-center">
                        <button type="button" class="btn btn-primary" style="width: 100%;" (click)="openDechargeModal(userContent8)" title="Imprimer décharge. Maximum 6 par page.">Décharge (V2)</button>
                    </div> -->
                    <div *ngIf="!isVisible" align="right" class="col-md-2 text-xs-center">
                      <label style="display: none;" for="user-file-upload" class="custom-file-upload btn-sm"><i class="fa fa-cloud-upload" title="Importer du fichier excel."></i></label>
                      <button class="mt-2" type="button" mat-raised-button (click)="fileInput.click()" style="background-color: #00b3ee; color: white; width: 100%">Importer fichier excel <mat-icon>file_download</mat-icon></button>
                      <input #fileInput id="user-file-upload" type="file" (change)="onFileChange($event, userContentImport);" style="display: none;"/>
                    </div>
                    <div *ngIf="!isVisible" align="right" class="col-md-2 mt-2 text-xs-center">
                      <button type="button" mat-raised-button style="background-color: #00b3ee; color: white; width: 100%" (click)="openmodelExport(userContentexport)" >Exporter colis <mat-icon>file_upload</mat-icon></button>
<!--
                      <label for="user-file-download" class="custom-file-upload btn-sm"><i class="fa fa-cloud-download" title="Exporter fichier excel." (click)="openmodelExport(userContentexport);"></i></label>
-->
                    </div>

                    <div *ngIf="!isVisible" align="right" class="col-xl-2 mt-2 text-xs-center">
                      <button type="button" mat-raised-button  (click)="open(userContentRC)" style="background-color: #00b3ee; color: white; width: 100%" >Bon de Ramassage </button>
<!--
                      <button type="button" class="btn btn-primary btn-sm" title="Imprimer bon de livraison." (click)="open(userContentRC)">Bon de Ramassage</button>
-->
                    </div>
                    <div class="col-xl-2 col-sm-12 text-xs-center mt-2">
                      <button type="button" mat-raised-button  title="vider list ." (click)="Viderlalist();selectAll($event)" style="background-color: #00b3ee; color: white; width: 100%">Vider la recherche <mat-icon>clear_all</mat-icon></button>
                    </div>

                    <div align="left" class="col-xl-2 col-sm-12 mt-2 text-xs-right">
                      <button type="button" mat-raised-button  title="Imprimer les bons de livraison." (click)="open(userContentBL)" style="background-color: #00b3ee; color: white; width: 100%">Impr BL Selectionés <mat-icon>print</mat-icon></button>
                    </div>

                    <div align="right" class="col-xl-2 mt-2 text-xs-center">
                      <button type="button" mat-raised-button  (click)="openAddModal(userContent3)" style="background-color: #41DB00; color: white; width: 100%" >Ajouter Nouveau Colis   <mat-icon>add_box</mat-icon></button>
<!--
                      <button type="button" class="btn btn-warning btn-sm" title="Ajouter un nouveau clois." (click)="openAddModal(userContent3)"><i class="fa fa-plus"></i></button>
-->
                    </div>
                  </div>
                  <div class="row" *ngIf="!isVisible" hidden>
                    <div align="right" class="col-xl-12 text-xs-center" align="right">
                      <button type="button" class="btn btn-rounded" style="width: 15%;" title="Imprimer manifeste." (click)="openDechargeModal(userContent6)">Manifeste</button>
                    </div>
                  </div>
                </div>
              </div>

            </div>
          </div>

        </div>

        <div class="card-header">
          <div class="row">
            <div class="col-md-2 text-xs-center">
              <fieldset class="scheduler-border-1">
                <legend class="scheduler-border-1">Date début</legend>
                <input id="user-startDateFilter" type="date" class="form-control" name="startDateFilter" [(ngModel)]="startDateFilter">
              </fieldset>
            </div>
            <div class="col-md-2 text-xs-center">
              <fieldset class="scheduler-border-1">
                <legend class="scheduler-border-1">Date fin</legend>
                <input id="user-endDateFilter" type="date" class="form-control" name="endDateFilter" [(ngModel)]="endDateFilter">
              </fieldset>
            </div>

            <div class="col-md-2 text-xs-center">
              <fieldset class="scheduler-border-1">
                <legend class="scheduler-border-1">Status de colis</legend>
                <select class="form-control" id="user-stateFilter" [(ngModel)]="stateFilter" name="stateFilter">
                  <option [ngValue]="'tous'">Tous</option>
                  <ng-container *ngFor="let status of statusList" class="form-control">
                    <option [ngValue]="status" >
                      {{status}}
                    </option>
                  </ng-container>
                </select>
              </fieldset>
            </div>

            <div class="col-md-2 text-xs-center">
              <fieldset class="scheduler-border-1">
                <legend class="scheduler-border-1">Status de paiement</legend>
                <select class="form-control" id="user-payementStatusFilter" [(ngModel)]="payementStatusFilter" name="payementStatusFilter">
                  <option [ngValue]="'En cours'">En cours de paiement et retour</option>
                  <option [ngValue]="'Payee'">Payé</option>
                  <option [ngValue]="'Retournee'">Retourné</option>
                  <option [ngValue]="'Prés-Recolté'">Prés-Récolté</option>
                  <option [ngValue]="'Récolté'">Récolté</option>
                  <option [ngValue]="'Non Récolté'">Non Récolté</option>
                  <option [ngValue]="'Récolté/RetourBC'">Récolté et Retour BC</option>
                  <option [ngValue]="'tous'">Tous</option>
                </select>
              </fieldset>
            </div>
            <div class="col-md-2 text-xs-center">
              <!-- <form class="form-inline my-2 my-lg-0">
                      <input class="form-control mr-sm-2" type="text" id="user-myInput" placeholder="Chercher" [(ngModel)]="searchTerm" [ngModelOptions]="{standalone: true}" (select)="setFilteredItems()">
              </form> -->
              <fieldset class="scheduler-border-1">
                <legend class="scheduler-border-1">Recherche Global</legend>
                <form class="form-inline mr-auto">
                  <input class="form-control" type="text" id="user-myInput" [(ngModel)]="searchTerm" [ngModelOptions]="{standalone: true}" placeholder="Chercher" aria-label="Search" width="100%">
                  <button class="btn btn-mdb-color btn-rounded btn-sm my-0 ml-sm-2" (click)="setFilteredItems()" type="submit" hidden><i class="fa fa-search"></i></button>
                </form>
              </fieldset>
            </div>
            <!--
            <div class="col-xl-2 text-xs-center">
                    <form class="form-inline my-2 my-lg-0">
                            <input class="form-control mr-sm-2" type="text" id="user-myInput" placeholder="Chercher" [(ngModel)]="searchTerm" [ngModelOptions]="{standalone: true}" (select)="setFilteredItems()">
                    </form>
                    <fieldset class="scheduler-border-1">
                            <legend class="scheduler-border-1">Recherche REF</legend>
                            <form class="form-inline mr-auto">
                                    <input class="form-control" type="text" id="user-myInput" [(ngModel)]="searchTerm" [ngModelOptions]="{standalone: true}" placeholder="Chercher" aria-label="Search" width="100%">
                                    <button class="btn btn-mdb-color btn-rounded btn-sm my-0 ml-sm-2" (click)="setFilteredItems()" type="submit" hidden><i class="fa fa-search"></i></button>
                            </form>
                    </fieldset>
            </div>
             -->
            <div class="col-md-2 text-xs-center">
              <fieldset class="scheduler-border-1">
                <legend class="scheduler-border-1">Action</legend>
                <button type="button" align="right" style="width: 100%" class="btn btn-blue" (click)="setFilteredItems()" type="submit" >Chercher</button>
              </fieldset>
            </div>


        </div>
        </div>

        <!-- <div ng-controller="MyCtrl">
                <ul>
                        <li *ngFor="let item of scans">{{trip.refTrip}}</li>
                </ul>
        </div> -->

        <div class="card-body table-responsive">
          <div class="row mb-2">
            <div class="col-xl-2 col-sm-12 text-xs-center mt-2"><input type="checkbox" [(ngModel)]="selectedAll" (change)="selectAll($event);"/> Sélectionner tout</div>
            <!--
            <div class="col-xl-3 text-xs-center" hidden>
                    <a [hidden]="prvBtnDisabled" (click)="getFiltredTripsOnPrevious()" class="previous">&laquo; Précédent</a>
                    <a [hidden]="nxtBtnDisabled" (click)="getFiltredTripsOnNext()" class="next">Suivant &raquo;</a>
            </div>  -->


            <small class="form-text text-primary mt-2" style="font-size:12px !important;">Nombre des colis selectionnées:  <b>{{NBchecked}}</b></small>
          </div>

          <table class="table" [mfData]="items.reverse()" #mf="mfDataTable" [mfRowsOnPage]="chooseView" id="user-myTable">
            <thead>
            <tr>
              <th style="width:1%">#</th>
              <th style="width:2%">REF</th>
              <th style="width:10%">Source</th>
              <th style="width:10%">Déstination</th>
              <th style="width:10%"><mfDefaultSorter by="statusTrip">Status</mfDefaultSorter></th>
              <th style="width:6%"><mfDefaultSorter by="userTrip.nameUser">Expéditeur</mfDefaultSorter></th>
              <th style="width:10%">Postulation</th>
              <th style="width:2%">Frais</th>
              <th style="width:3%">Prix</th>
              <th style="width:4%">E.financier</th>
              <th style="width:15%">Actions</th>
            </tr>
            </thead>

            <tbody>
            <tr *ngFor="let trip of mf.data" id="user-trip-row-{{trip.idTrip}}" >
              <!-- <td scope="row"><input class="form-check-input" type="checkbox" id="user-checked-trip-{{trip.idTrip}}" value="option1" (click)="checkedTrip(trip)"></td> -->
              <td scope="row"><input class="form-check-input" type="checkbox" id="user-checked-trip-{{trip.idTrip}}"
                                     [checked]=" checkScanId(trip.refTrip)" value="option1" [(ngModel)]="trip.selected" (change)="onCheckboxChange(trip,$event)"></td>
              <!-- <td *ngIf="showStatusTrip(trip) === true && showStatusTrip2(trip) === true" [ngStyle]="{'color': varcolor}">{{trip.refTrip}}</td>
              <td *ngIf="showStatusTrip(trip) === true && showStatusTrip2(trip) === false" style="background-color: rgb(216, 23, 23)">{{trip.refTrip}}</td> -->

              <td *ngIf="!isVisible">{{trip.refTrip}}</td>
              <td>{{trip.sourceTrip.cityAdr}}</td>
              <td>{{trip.destTrip.cityAdr}}</td>
              <td>{{trip.statusTrip}}</td>
              <td>{{ trip.userTrip.nameUser }}</td>
              <td>{{changeDateFormat(trip.createdday)}}</td>
              <td *ngIf="trip.modeTrip === 'Payer par expéditeur'" style="background-color: rgb(127, 231, 41)">{{ trip.costTrip }}</td>
              <td *ngIf="trip.modeTrip !== 'Payer par expéditeur'" >{{ trip.costTrip }}</td>
              <td>{{ trip.packageTrip.valPackage }}</td>
              <td>{{ showFinancialStatus(trip) }}</td>
              <td>
                <button  type="button" class="mat-mini-fab" title="Modifier" >
                  <i class="material-icons" (click)="editTrip(userContent, trip)"> create </i>
                </button>
                <!--<button type="button" class="mat-mini-fab" title="Dupliquer" (click)="open(userContent1)" hidden>
                        <i class="material-icons"> file_copy </i>
                </button>-->
                <button *ngIf="!dataUser.role" type="button" class="mat-mini-fab" title="Supprimer">
                  <i class="material-icons" (click)="openBlModal2(userContentdeleteTrip,trip)" > delete </i>
                </button>
                <button type="button" class="mat-mini-fab" title="Détails">
                  <i class="material-icons" (click)="infoTrip(userContent2, trip)"> open_in_new </i>
                </button>
                <button type="button" class="mat-mini-fab" title="Envoyer le bon de livraison">
                  <i class="material-icons" (click)="openBlModal(userContent7, trip)"> call_made </i>
                </button>
                <!--<button type="button" class="mat-mini-fab" title="Ajuster la position de déstinataire" (click)="openLinkPos(trip.idTrip)">
                        <i class="material-icons"> my_location </i>
                </button>-->
                <button type="button" class="mat-mini-fab" title="Générer le bon de livraison" (click)="selectOne(trip);BLFromServer(userContentBLTelechargement)">
                  <i class="material-icons"> file_download </i>
                </button>
                <!--<button *ngIf="isVisible" type="button" class="mat-mini-fab" title="argentRecolte" (click)="openBlModal2(userContentupdateargentR, trip)">
                        <i class="material-icons"> local_atm </i>
                </button>-->
              </td>

            </tr>
            </tbody>
            <tfoot>
            <tr>
              <td align="right" colspan="8">
                <mfBootstrapPaginator [rowsOnPageSet]="[]"></mfBootstrapPaginator>

                <!--
                 <a [hidden]="prvBtnDisabled" (click)="getFiltredTripsOnPrevious()" class="previous">&laquo; Précédent</a>
                 <a [hidden]="nxtBtnDisabled" (click)="getFiltredTripsOnNext()" class="next">Suivant &raquo;</a> -->
                <!-- <a [hidden]="!prvBtnDisabled" (click)="getTripsOnPrevious(pDate)" class="previous">&laquo; Précédent</a>
                <a [hidden]="!nxtBtnDisabled" (click)="getTripsOnNext(nDate)" class="next">Suivant &raquo;</a> -->
              </td>
            </tr>
            </tfoot>
          </table>

        </div>
      </div>
    </div>
  </div>
</div>

<ng-template #userContent let-c="close" let-c="dismiss">
  <div class="modal-header">
    <h4 class="modal-title">Edit de trip:&nbsp; {{objTrip.refTrip}}</h4>
    <button type="button" class="close" aria-label="Close" (click)="c('Cross click')">
      <span aria-hidden="true">&times;</span>
    </button>
  </div>
  <div class="modal-body">
    <div class="row">
      <div class="col-xl-6 text-xs-center">
        <div class="form-group">
          <label for="user-inputSourceTrip">Adresse source</label> &nbsp;<!-- <button type="button" id="user-btnShowHide1" class="btn btn-warning btn-sm" (click)="EditAddressSource()">Editer</button> -->
          <!-- <input *ngIf="!disableInputValTrip" type="text" class="form-control" id="user-inputSourceTrip" [(ngModel)]="objTrip.sourceTrip.cityAdr" name="inputSourceTrip" disabled>
           <input *ngIf="disableInputValTrip"  type="text" class="form-control" id="user-inputSourceTrip" [(ngModel)]="objTrip.sourceTrip.cityAdr" name="inputSourceTrip" disabled>     -->
          <input type="text" class="form-control" id="user-inputSourceTrip" [(ngModel)]="objTrip.sourceTrip.cityAdr" name="inputSourceTrip" disabled>
        </div>

        <div class="form-group">
          <label for="user-inputDestTrip">Adresse déstination</label> &nbsp; <button type="button" id="user-btnShowHide" class="btn btn-warning btn-sm" (click)="EditAddressDest()">Editer</button>
          <input type="text" class="form-control" id="user-inputDestTrip" [(ngModel)]="objTrip.destTrip.cityAdr" name="inputDestTrip" disabled>
        </div>
        <div class="col-xl-12 text-xs-center" id="user-newAdrDest">
          <fieldset class="scheduler-border-1">
            <legend class="scheduler-border-1">Nouvelle adresse de déstinataire</legend>
            <div class="control-group">
              <div class="row">
                <div class="col-xl-12 text-xs-center">
                  <input type="text" class="form-control" id="user-cityAdresseDestUp" name="cityAdresseDestUp" [(ngModel)]="cityAdresseDestUp" placeholder="Adresse" autocomplete="on">
                </div>
              </div>

              <div class="row">
                <div class="col-xl-12 text-xs-center">
                  <input type="text" class="form-control" pattern="[0-9]*" maxlength="4" required name="zipCodeUp" id="user-zipCodeUp" placeholder="Tapez ici le code postal" [(ngModel)]="zipCodeUp" (keyup)="resetDelegInputUp()">
                </div>
              </div>
              <div class="row">
                <div class="col-xl-12 text-xs-center">
                  <select id="user-gouvernoratUp" name="gouvernoratUp" class="form-control" [(ngModel)]="gouvernoratUp" (change)="getDelegFromGovOnUp(); onKeyAdrUp();">
                    <option value="">-- Gouvernorat --</option>
                  </select>
                </div>
              </div>
              <div class="row" hidden>
                <div class="col-xl-12 text-xs-center">
                  <select id="user-delegationUp" name="delegationUp" class="form-control" [(ngModel)]="delegationUp" (change)="getAdrFromIndex()">
                    <option value="">-- Delegation --</option>
                  </select>
                </div>
              </div>
              <div class="row">
                <div class="col-xl-12 text-xs-center">
                  <ng2-completer [inputClass]="'form-control form-control-inline'" [datasource]="tunisiaData" [minSearchLength]="0" [textSearching]="'Cherche...'"
                                 [textNoResults]="'Pas trouvé.'" [placeholder]="'Entrer la ville'" id="user-delegationUp" name="delegationUp" [(ngModel)]="delegationUp"
                                 (selected)="getAdrFromIndex()" (keyup)="onKeyAdrUp()">
                  </ng2-completer>
                </div>
              </div>

              <input type="text" class="form-control" id="user-latGlobalDestUp" name="latGlobalDestUp" [(ngModel)]="latGlobalDestUp" hidden>
              <input type="text" class="form-control" id="user-lngGlobalDestUp" name="lngGlobalDestUp" [(ngModel)]="lngGlobalDestUp" hidden>
              <input type="text" class="form-control" id="user-cityGlobalDestUp" name="cityGlobalDestUp" [(ngModel)]="cityGlobalDestUp" hidden>

              <input type="text" class="form-control" id="user-latAdrUp" name="latAdrUp" [(ngModel)]="latAdrUp" hidden>
              <input type="text" class="form-control" id="user-lngAdrUp" name="lngAdrUp" [(ngModel)]="lngAdrUp" hidden>
              <input type="text" class="form-control" id="user-cityAdrUp" name="cityAdrUp" [(ngModel)]="cityAdrUp" hidden>
            </div>
          </fieldset>
        </div>
        <div class="form-group">
          <label for="user-inputContactDestTrip">Contact de déstinataire</label>
          <input *ngIf="!disableInputValTrip"  type="text" class="form-control" id="user-inputContactDestTrip" [(ngModel)]="objTrip.destTrip.contactAdr" name="inputContactDestTrip">
          <input *ngIf="disableInputValTrip" type="text" class="form-control" id="user-inputContactDestTrip" [(ngModel)]="objTrip.destTrip.contactAdr" name="inputContactDestTrip" disabled>
        </div>
        <div class="form-group">
          <label for="user-inputTelDestTrip">Téléphone de déstinataire</label>
          <div class="row">
            <div class="col-xl-6">
              <input *ngIf="!disableInputValTrip" type="text" maxlength="8" class="form-control" id="user-inputTelDestTrip" [(ngModel)]="objTrip.destTrip.mobileAdr" name="inputTelDestTrip">
              <input *ngIf="disableInputValTrip" type="text" maxlength="8" class="form-control" id="user-inputTelDestTrip" [(ngModel)]="objTrip.destTrip.mobileAdr" name="inputTelDestTrip" disabled>
            </div>
            <div class="col-xl-6">
              <input *ngIf="!disableInputValTrip" type="text" maxlength="8" class="form-control" id="user-inputTelDestTrip2" [(ngModel)]="objTrip.destTrip.mobileAdr2" name="inputTelDestTrip2" >
              <input *ngIf="disableInputValTrip" type="text" maxlength="8" class="form-control" id="user-inputTelDestTrip2" [(ngModel)]="objTrip.destTrip.mobileAdr2" name="inputTelDestTrip2" disabled>
            </div>
          </div>
        </div>
        <div class="form-group">
          <label for="user-inputCodeExp">Code éxpéditeur</label>
          <input *ngIf="!isVisible" type="text" class="form-control" [(ngModel)]="objTrip.codeExp" [attr.disabled]="true">
        </div>
        <div class="form-group">
          <label for="user-inputCodeDest">Code déstinataire</label>
          <input *ngIf="!isVisible" type="text" class="form-control" [(ngModel)]="objTrip.codeTrip" [attr.disabled]="true">
        </div>
        <div class="form-group">
          <label for="user-inputDelais">Délais</label>
          <input *ngIf="!isVisible" type="text" class="form-control" [(ngModel)]="objTrip.timingTrip" [attr.disabled]="true">
        </div>
        <div class="form-group">
          <label for="user-inputStatusAc">Status actuelle</label>
          <input *ngIf="!isVisible" type="text" class="form-control" [(ngModel)]="objTrip.statusTrip" [attr.disabled]="true">


        </div>
        <div class="form-group" *ngIf="objTrip.prevStatusTrip  || isVisible">
          <label for="user-inputStatusPr">Status précédente</label>
          <input *ngIf="!isVisible" type="text" class="form-control" [(ngModel)]="objTrip.prevStatusTrip" [attr.disabled]="true">
        </div>
      </div>
      <div class="col-xl-6 text-xs-center">
        <div class="form-group">
          <label for="user-inputDateCr">Date de création</label>
          <input *ngIf="!isVisible" type="text" class="form-control" [(ngModel)]="objTrip.createdday" [attr.disabled]="true">
        </div>
        <div class="form-group" *ngIf="objTrip.affectedday || isVisible">
          <label for="user-inputDateAf">Date d'affectation</label>
          <input *ngIf="!isVisible" type="text" class="form-control" [(ngModel)]="objTrip.affectedday" [attr.disabled]="true">
        </div>
        <div class="form-group" *ngIf="objTrip.getedday || isVisible">
          <label for="user-inputDateRec">Date de récupération</label>
          <input *ngIf="!isVisible" type="text" class="form-control" [(ngModel)]="objTrip.getedday"[attr.disabled]="true">
        </div>
        <div class="form-group" *ngIf="objTrip.startdelday || isVisible">
          <label for="user-inputDateStartLiv">Date début de livraison</label>
          <input *ngIf="!isVisible" type="text" class="form-control" [(ngModel)]="objTrip.startdelday" [attr.disabled]="true">
        </div>
        <div class="form-group" *ngIf="objTrip.livredday || isVisible">
          <label for="user-inputDateEndLiv">Date fin de livraison</label>
          <input *ngIf="!isVisible" type="text" class="form-control" [(ngModel)]="objTrip.livredday" [attr.disabled]="true">
        </div>
        <div class="form-group" *ngIf="objTrip.prereturnedday || isVisible">
          <label for="user-inputReturnedday">Date de retour</label>
          <input *ngIf="!isVisible" type="text" class="form-control" [(ngModel)]="objTrip.prereturnedday" [attr.disabled]="true">
        </div>
        <div class="form-group" *ngIf="objTrip.costTrip || isVisible">
          <label for="user-inputCostTrip">Coût de livraison</label>
          <input *ngIf="!isVisible" type="text" class="form-control" [(ngModel)]="objTrip.costTrip" [attr.disabled]="true">
        </div>
        <div class="form-group">
          <label for="user-inputValTrip">Valeur de colis</label>
          <input *ngIf="!disableInputValTrip" type="text" class="form-control" id="user-inputValTrip" [(ngModel)]="objTrip.packageTrip.valPackage" name="inputValTrip">
          <input *ngIf="disableInputValTrip" type="text" class="form-control" id="user-inputValTrip" [(ngModel)]="objTrip.packageTrip.valPackage" name="inputValTrip" [attr.disabled]="true">
        </div>
        <div class="form-group">
          <label for="user-inputDescpTrip">Description</label>
          <input *ngIf="!disableInputValTrip" type="text" class="form-control" id="user-inputDescpTrip" [(ngModel)]="objTrip.descriptionTrip" name="inputDescpTrip">
          <input *ngIf="disableInputValTrip" type="text" class="form-control" id="user-inputDescpTrip" [(ngModel)]="objTrip.descriptionTrip" name="inputDescpTrip" disabled>
        </div>
      </div>
    </div>
  </div>
  <div class="modal-footer">
    <button type="button" class="btn btn-danger" (click)="c('Close click')">Fermer</button>
    <button type="button" class="btn btn-primary" (click)="updatetrip();c('Cross click')" >Sauvegarder</button>
  </div>
</ng-template>

<ng-template #userContent1 let-c="close" let-d="dismiss">
  <div class="modal-header">
    <h4 class="modal-title">Duplicate</h4>
    <button type="button" class="close" aria-label="Close" (click)="d('Cross click')">
      <span aria-hidden="true">&times;</span>
    </button>
  </div>
  <div class="modal-body">
    <div class="row">
      <div class="col-xl-6 text-xs-center">
        <div class="form-group">
          <label for="user-inputCodeExp">Code éxpéditeur</label>
          <input type="text" class="form-control" id="user-inputCodeExp">
        </div>
        <div class="form-group">
          <label for="user-inputCodeDest">Code déstinataire</label>
          <input type="text" class="form-control" id="user-inputCodeDest">
        </div>
        <div class="form-group">
          <label for="user-inputDelais">Délais</label>
          <input type="text" class="form-control" id="user-inputDelais">
        </div>
        <div class="form-group">
          <label for="user-inputStatusAc">Status actuelle</label>
          <input type="text" class="form-control" id="user-inputStatusAc">
        </div>
        <div class="form-group">
          <label for="user-inputStatusPr">Status précédente</label>
          <input type="text" class="form-control" id="user-inputStatusPr">
        </div>
      </div>
      <div class="col-xl-6 text-xs-center">
        <div class="form-group">
          <label for="user-inputDateCr">Date de création</label>
          <input type="text" class="form-control" id="user-inputDateCr">
        </div>
        <div class="form-group">
          <label for="user-inputDateAf">Date d'affectation</label>
          <input type="text" class="form-control" id="user-inputDateAf">
        </div>
        <div class="form-group">
          <label for="user-inputDateRec">Date de récupération</label>
          <input type="text" class="form-control" id="user-inputDateRec">
        </div>
        <div class="form-group">
          <label for="user-inputDateStartLiv">Date début de livraison</label>
          <input type="text" class="form-control" id="user-inputDateStartLiv">
        </div>
        <div class="form-group">
          <label for="user-inputDateEndLiv">Date fin de livraison</label>
          <input type="text" class="form-control" id="user-inputDateEndLiv">
        </div>
      </div>
    </div>
  </div>
  <div class="modal-footer">
    <button type="button" class="btn btn-danger" (click)="c('Close click')">Close</button>
    <button type="button" class="btn btn-primary" >Sauvegarder</button>
  </div>
</ng-template>


<ng-template #userContent2 let-c="close" let-d="dismiss">
  <div class="modal-header">
    <h4 class="modal-title">Détails de trip:&nbsp; {{objTrip.refTrip}} </h4>
    <button type="button" class="close" aria-label="Close" (click)="d('Cross click')">
      <span aria-hidden="true">&times;</span>
    </button>
  </div>
  <div class="modal-body">
    <div class="row">
      <div class="col-xl-4 text-xs-center"  *ngIf="objTrip.codeExp">
        <fieldset class="scheduler-border">
          <legend class="scheduler-border text-center"><h6>Code éxpéditeur</h6></legend>
          <div class="control-group">
            <label class="text-center font-weight-light">{{objTrip.codeExp}}</label>
          </div>
        </fieldset>
      </div>
      <div class="col-xl-4 text-xs-center" *ngIf="objTrip.codeTrip">
        <fieldset class="scheduler-border">
          <legend class="scheduler-border"><h6>Code déstinataire</h6></legend>
          <div class="control-group">
            <label  center class="font-weight-light text-center">{{objTrip.codeTrip}}</label>
          </div>
        </fieldset>
      </div>
      <div class="col-xl-4 text-xs-center" *ngIf="objTrip.userTrip.nameUser && objTrip.userTrip.mobileUser">
        <fieldset class="scheduler-border">
          <legend class="scheduler-border"><h6>Expéditeur</h6></legend>
          <div class="control-group">
            <label center class="font-weight-light">{{objTrip.userTrip.nameUser}}&nbsp;-&nbsp;{{objTrip.userTrip.mobileUser}}</label>
          </div>
        </fieldset>
      </div>

      <div class="col-xl-4 text-xs-center" *ngIf="objTrip.destTrip.contactAdr && objTrip.destTrip.mobileAdr">
        <fieldset class="scheduler-border">
          <legend class="scheduler-border"><h6>Déstinateur</h6></legend>
          <div class="control-group">
            <label  center class="font-weight-light">{{objTrip.destTrip.contactAdr}}&nbsp;-&nbsp;{{objTrip.destTrip.mobileAdr}}&nbsp;-&nbsp;{{objTrip.destTrip.mobileAdr2}}</label>
          </div>
        </fieldset>
      </div>
      <div class="col-xl-4 text-xs-center">
        <fieldset class="scheduler-border">
          <legend class="scheduler-border"><h6>Conducteur</h6></legend>
          <div class="control-group">
            <label center class="font-weight-light" *ngIf="objTrip.driverTrip !== null">{{objTrip.driverTrip.nameDriver}}&nbsp;-&nbsp;{{objTrip.driverTrip.surnameDriver}}&nbsp;-&nbsp;{{objTrip.driverTrip.mobileDriver}}</label>
            <label align ="center" class="font-weight-light" *ngIf="objTrip.driverTrip === null">---</label>
          </div>
        </fieldset>
      </div>
      <div class="col-xl-4 text-xs-center" *ngIf="objTrip.timingTrip">
        <fieldset class="scheduler-border">
          <legend class="scheduler-border"><h6>Délais</h6></legend>
          <div class="control-group">
            <label center class="font-weight-light">{{objTrip.timingTrip}}</label>
          </div>
        </fieldset>
      </div>

      <div class="col-xl-4 text-xs-center" *ngIf="objTrip.statusTrip">
        <fieldset class="scheduler-border">
          <legend class="scheduler-border"><h6>Status actuelle</h6></legend>
          <div class="control-group">
            <label  class="font-weight-light">{{objTrip.statusTrip}}</label>
          </div>
        </fieldset>
      </div>
      <div class="col-xl-4 text-xs-center" *ngIf="objTrip.prevStatusTrip">
        <fieldset class="scheduler-border">
          <legend class="scheduler-border"><h6>Status précédente</h6></legend>
          <div class="control-group">
            <label  class="font-weight-light">{{objTrip.prevStatusTrip}}</label>
          </div>
        </fieldset>
      </div>
      <div class="col-xl-4 text-xs-center" *ngIf="objTrip.costTrip">
        <fieldset class="scheduler-border">
          <legend class="scheduler-border"><h6>Coût de livraison</h6></legend>
          <div class="control-group">
            <label  class="font-weight-light">{{objTrip.costTrip}}</label>
          </div>
        </fieldset>
      </div>
      <div class="col-xl-4 text-xs-center" *ngIf="objTrip.packageTrip.valPackage">
        <fieldset class="scheduler-border">
          <legend class="scheduler-border"><h6>Valeur de colis</h6></legend>
          <div class="control-group">
            <label  class="font-weight-light">{{objTrip.packageTrip.valPackage}}</label>
          </div>
        </fieldset>
      </div>

      <div class="col-xl-4 text-xs-center" *ngIf="objTrip.createdday">
        <fieldset class="scheduler-border">
          <legend class="scheduler-border"><h6>Date de postulation</h6></legend>
          <div class="control-group">
            <label  class="font-weight-light">{{changeDateFormat(objTrip.createdday)}}</label>
          </div>
        </fieldset>
      </div>
      <div class="col-xl-4 text-xs-center" *ngIf="objTrip.affectedday">
        <fieldset class="scheduler-border">
          <legend class="scheduler-border"><h6>Date d'affectation</h6></legend>
          <div class="control-group">
            <label  class="font-weight-light">{{changeDateFormat(objTrip.affectedday)}}</label>
          </div>
        </fieldset>
      </div>
      <div class="col-xl-4 text-xs-center" *ngIf="objTrip.getedday">
        <fieldset class="scheduler-border">
          <legend class="scheduler-border"><h6>Date de ramassage</h6></legend>
          <div class="control-group">
            <label  class="font-weight-light">{{changeDateFormat(objTrip.getedday)}}</label>
          </div>
        </fieldset>
      </div>

      <div class="col-xl-4 text-xs-center" *ngIf="objTrip.startdelday">
        <fieldset class="scheduler-border">
          <legend class="scheduler-border"><h6>Début de livraison</h6></legend>
          <div class="control-group">
            <label  class="font-weight-light">{{changeDateFormat(objTrip.startdelday)}}</label>
          </div>
        </fieldset>
      </div>
      <div class="col-xl-4 text-xs-center" *ngIf="objTrip.livredday">
        <fieldset class="scheduler-border">
          <legend class="scheduler-border"><h6>Fin de livraison</h6></legend>
          <div class="control-group">
            <label  class="font-weight-light">{{changeDateFormat(objTrip.livredday)}}</label>
          </div>
        </fieldset>
      </div>
      <div class="col-xl-4 text-xs-center" *ngIf="objTrip.prereturnedday">
        <fieldset class="scheduler-border">
          <legend class="scheduler-border"><h6>Date de retour</h6></legend>
          <div class="control-group">
            <label  class="font-weight-light">{{changeDateFormat(objTrip.prereturnedday)}}</label>
          </div>
        </fieldset>
      </div>

      <div class="col-xl-4 text-xs-center" *ngIf="objTrip.descriptionTrip">
        <fieldset class="scheduler-border">
          <legend class="scheduler-border"><h6>Description</h6></legend>
          <div class="control-group">
            <label  class="font-weight-light">{{objTrip.descriptionTrip}}</label>
          </div>
        </fieldset>
      </div>
      <div class="col-xl-4 text-xs-center" *ngIf="objTrip.lastupdateby!==null">
        <fieldset class="scheduler-border">
          <legend class="scheduler-border"><h6>Dernière modification</h6></legend>
          <div class="control-group">
            <ul>
              <li>{{objTrip.lastupdateby}}
                <ul>
                  <li>{{objTrip.lastupdateday}}</li>
                </ul>
              </li>
            </ul>
          </div>
        </fieldset>
      </div>

    </div>
    <div class="row">
      <div class="col-xl-4 text-xs-center" *ngIf="objTrip.msgTrip && objTrip.msgTrip.length > 0">
        <fieldset class="scheduler-border">
          <legend class="scheduler-border"><h6>Messages</h6></legend>
          <div class="control-group">
            <ul *ngFor="let msg of objTrip.msgTrip">
              <li>{{msg.contentMsg}}
                <ul>
                  <li>{{msg.ownerMsg}}</li>
                  <li>{{changeDateFormat(msg.dateMsg)}}</li>
                </ul>
              </li>
            </ul>
          </div>
        </fieldset>
      </div>
      <div class="col-xl-4 text-xs-center" *ngIf="objTrip.listdriverTrip && objTrip.listdriverTrip.length > 0">
        <fieldset class="scheduler-border">
          <legend class="scheduler-border"><h6>Historique des condicteurs</h6></legend>
          <div class="control-group">
            <ul *ngFor="let driver of objTrip.listdriverTrip">
              <li>{{driver.nameDriver}} {{driver.surnameDriver}}
                <ul>
                  <li>{{driver.changedDateDriver}}</li>
                </ul>
              </li>
            </ul>
          </div>
        </fieldset>
      </div>
      <div class="col-xl-4 text-xs-center" *ngIf="objTrip.image">
        <fieldset class="scheduler-border">
          <legend class="scheduler-border"><h6>Image de colis</h6></legend>
          <div class="control-group">
            <img [src]="objTrip.image" style="width: 50%; height: 50%;"/>
          </div>
        </fieldset>
      </div>
      <div class="col-xl-4 text-xs-center">
        <fieldset class="scheduler-border">
          <legend class="scheduler-border"><h6>Entrepot</h6></legend>
          <div class="control-group">
            <p>{{!!objTrip.entrepot?objTrip.entrepot.nom:'-'}}</p>
          </div>
        </fieldset>
      </div>
    </div>
  </div>


  <div class="modal-footer">
    <button type="button" class="btn btn-danger" (click)="c('Close click')">Fermer</button>
  </div>
</ng-template>

<ng-template #userContent3 let-c="close" let-d="dismiss" id="user-modalAdd">
  <div class="modal-header">
    <h4 class="modal-title">Ajouter un colis</h4>
    <button type="button" class="close" aria-label="Close" (click)="d('Cross click')">
      <span aria-hidden="true">&times;</span>
    </button>
  </div>
  <div class="modal-body">
    <div class="row">
      <div class="col-xl-12 text-xs-center">
        <fieldset class="scheduler-border">
          <legend class="scheduler-border">Expéditeur</legend>
          <div class="control-group">
            <div class="row">
              <div class="col-xl-4 text-xs-center">
                <div class="form-group">
                  <small class="form-text text-primary" style="font-size:10px !important;">Choisissez une adresse déjà enregistrée.</small>
                  <select id="user-inputExpAdresseName" class="form-control" (change)="onClickAdrExp()" [(ngModel)]="selectedAdresseExp">
                    <option *ngFor="let adresse of Adresses" [ngValue]="adresse">
                      {{ adresse.labelAdr }}
                    </option>
                  </select>
                </div>
                <div class="form-group"><input type="text" class="form-control" id="user-inputExpAdresseCity" name="inputExpAdresseCity" [(ngModel)]="cityAdresseExp" placeholder="Adresse" disabled></div>
              </div>
              <div class="col-xl-4 text-xs-center">
                <h6><span>.</span></h6>
                <div class="form-group"><input type="text" class="form-control" id="user-inputExpContact" name="inputExpContact" [(ngModel)]="contactAdresseExp" placeholder="Nom de contact" disabled></div>
                <div class="form-group"><input type="text" class="form-control" id="user-inputExpTel" name="inputExpTel" [(ngModel)]="telContAdresseExp" placeholder="Téléphone de contact" disabled></div>
              </div>
            </div>
          </div>
        </fieldset>
      </div>
    </div>
    <div class="row">
      <!-- <div class="col-xl-6 text-xs-center">
              <fieldset class="scheduler-border">
                      <legend class="scheduler-border">Expéditeur</legend>
                      <div class="control-group">
                              <div class="form-group">
                                              <h6><span>Sélectionner l'adresse source:</span></h6>
                                      <select id="user-inputExpAdresseName" class="form-control" (change)="onClickAdrExp()" [(ngModel)]="selectedAdresseExp">
                                              <option *ngFor="let adresse of Adresses" [ngValue]="adresse">
                                                      {{ adresse.labelAdr }}
                                              </option>
                                      </select>
                              </div>
                              <div class="form-group"><input type="text" class="form-control" id="user-inputExpAdresseCity" name="inputExpAdresseCity" [(ngModel)]="cityAdresseExp" placeholder="Adresse" disabled></div>
                              <div class="form-group"><input type="text" class="form-control" id="user-inputExpContact" name="inputExpContact" [(ngModel)]="contactAdresseExp" placeholder="Nom de contact" disabled></div>
                              <div class="form-group"><input type="text" class="form-control" id="user-inputExpTel" name="inputExpTel" [(ngModel)]="telContAdresseExp" placeholder="Téléphone de contact" disabled></div>
                      </div>
              </fieldset>
      </div> -->
      <div class="col-xl-12 text-xs-center">
        <fieldset class="scheduler-border">
          <legend class="scheduler-border">Déstinataire</legend>
          <div class="control-group">
              <div class="row">
                <div class="col-xl-12 text-xs-center">
                  <div class="form-group">
                    <small class="form-text text-primary" style="font-size:10px !important;">Choisissez une adresse déjà enregistrée ou créer une nouvelle adresse.</small>
                    <select id="user-inputDestAdresseName" class="form-control" (change)="onClickAdrDest()" [(ngModel)]="selectedAdresseDest">
                      <option *ngFor="let adresse of Adresses" [ngValue]="adresse">
                        {{ adresse.labelAdr }}
                      </option>
                    </select>
                  </div>
                </div>
              </div>
              <div class="row">
                <div class="col-xl-3">
                  <div class="form-group"><input type="text" class="form-control" id="user-inputDestAdresseCity" name="inputDestAdresseCity" [(ngModel)]="cityAdresseDest" placeholder="Adresse" autocomplete="on"></div>
                </div>
                <div class="col-xl-3">
                      <div class="form-group"><input type="text" class="form-control" id="user-inputDestContact" name="inputDestContact" [(ngModel)]="contactAdresseDest" placeholder="Nom de contact"></div>
                    </div>
                    <div class="col-xl-3 text-xs-center">
                      <div class="form-group"><input type="text" class="form-control" id="user-inputDestTel" name="inputDestTel" [(ngModel)]="telContAdresseDest" placeholder="Téléphone 1"></div>
                    </div>
                    <div class="col-xl-3 text-xs-center">
                      <div class="form-group"><input type="text" class="form-control" id="user-inputDestTel2" name="inputDestTel2" [(ngModel)]="telContAdresseDest2" placeholder="Téléphone 2"></div>
                    </div>

              </div>
            <div class="row">
              <div class="col-xl-3 text-xs-center">
                <select id="user-gouvernorat" name="gouvernorat" class="form-control" [(ngModel)]="gouvernorat" (change)="getDelegFromGov(); onKeyAdr();">
                  <option value="">-- Gouvernorat --</option>
                </select>
              </div>
              <div class="col-xl-3 text-xs-center">
                <div class="form-group" id="user-gouv_del">
                  <input type="text" class="form-control" pattern="[0-9]*" maxlength="4" required name="zipCode" id="user-zipCode" placeholder="Tapez ici le code postal" [(ngModel)]="zipCode" (keyup)="resetDelegInput()">
                </div>
              </div>

              <div class="col-xl-3 text-xs-center" hidden>
                <select id="user-delegationn" name="delegationn" class="form-control" [(ngModel)]="delegation" (change)="getGovAndDelegFromIndex()">
                  <option value="">-- Delegation --</option>
                </select>
              </div>
              <div class="col-xl-3 text-xs-center">
                <div class="form-group" id="user-del">
                  <ng2-completer [inputClass]="'form-control form-control-inline'" [datasource]="tunisiaData" [minSearchLength]="0" [textSearching]="'Cherche...'"
                                 [textNoResults]="'Pas trouvé.'" [placeholder]="'Entrer la ville'" id="user-delegation" name="delegation" [(ngModel)]="delegation"
                                 (selected)="getGovAndDelegFromIndex()" (keyup)="onKeyAdr()">
                  </ng2-completer>
                </div>
              </div>
            </div>
            <!-- <div class="row" hidden>
                    <div class="col-xl-4 text-xs-center">
                            <div class="form-group" id="user-gouv_del">
                                    <input type="text" class="form-control" pattern="[0-9]*" maxlength="4" required name="zipCode" id="user-zipCode" placeholder="Tapez ici le code postal" [(ngModel)]="zipCode">
                            </div>
                    </div>
                    <div class="col-xl-4 text-xs-center">
                            <select id="user-gouvernorat" name="gouvernorat" class="form-control" [(ngModel)]="gouvernorat">
                                    <option value="">-- Gouvernorat --</option>
                            </select>
                    </div>
                    <div class="col-xl-4 text-xs-center">
                            <div class="form-group" id="user-delegatio">
                                    <ng2-completer input-class="form-control form-control-small" [(ngModel)]="delegation" [datasource]="tunisiaData" [minSearchLength]="0" [autofocus]="true"
                                            [minSearchLength]="0" [clearSelected]="true" [selectOnClick]="true"></ng2-completer>
                            </div>
                    </div>
            </div>  -->
            <!-- <input type="text" class="form-control" id="user-inputComposedAdresse" name="inputComposedAdresse" [(ngModel)]="inputComposedAdresse" >
            <input type="text" id="user-latitude2" name="latitude2" [(ngModel)]="latitude2" readonly  />
            <input type="text" id="user-longitude2" name="longitude2" [(ngModel)]="longitude2" readonly  /> -->

            <input type="text" class="form-control" id="user-latGlobalDest" name="latGlobalDest" [(ngModel)]="latGlobalDest" hidden>
            <input type="text" class="form-control" id="user-lngGlobalDest" name="lngGlobalDest" [(ngModel)]="lngGlobalDest" hidden>
            <input type="text" class="form-control" id="user-cityGlobalDest" name="cityGlobalDest" [(ngModel)]="cityGlobalDest" hidden>

          </div>
        </fieldset>
      </div>
    </div>
    <div class="row">
      <div class="col-xl-12 text-xs-center">
        <fieldset class="scheduler-border">
          <legend class="scheduler-border">Colis</legend>
          <div class="control-group">
            <div class="row">
              <div class="col-xl-12 text-xs-center">
                <fieldset class="scheduler-border">
                  <legend class="scheduler-border">Type de colis</legend>
                  <div class="control-group">
                    <div class="row">
                      <div class="col-xl-3 text-xs-center" style="margin-left: 10px;">
                        <input type="radio" class="form-check-input" id="user-rd-type1-trip" name="rd-btn-type-trip" (click)="show1()" value="pack" [(ngModel)]="selectedTripType" mdbInputDirective>
                        <label class="form-check-label" for="user-rd-type1-trip">Petit</label>
                      </div>
                      <div class="col-xl-3 text-xs-center" style="margin-left: 10px;">
                        <input type="radio" class="form-check-input" id="user-rd-type2-trip" name="rd-btn-type-trip" (click)="show2()" value="packbig" [(ngModel)]="selectedTripType" mdbInputDirective>
                        <label class="form-check-label" for="user-rd-type2-trip">Grand</label>
                      </div>
                      <div class="col-xl-3 text-xs-center" style="margin-left: 10px;">
                        <input type="radio" class="form-check-input" id="user-rd-type3-trip" name="rd-btn-type-trip" (click)="show1()" value="doc" [(ngModel)]="selectedTripType" mdbInputDirective>
                        <label class="form-check-label" for="user-rd-type3-trip">Document</label>
                      </div>
                    </div>
                  </div>
                </fieldset>
              </div>
            </div>
            <div class="row">
              <div id="user-div_dimensions" class="col-xl-12 text-xs-center" style="display: none;">
                <fieldset class="scheduler-border">
                  <legend class="scheduler-border">Dimensions et poids de colis</legend>
                  <div class="control-group">
                    <div class="row">
                      <div class="col-xl-4 text-xs-center">
                        <input type="text" class="form-control" id="user-inputTripDim1" name="inputTripDim1" [(ngModel)]="longueurTrip" placeholder="Longueur">
                      </div>
                      <div class="col-xl-4 text-xs-center">
                        <input type="text" class="form-control" id="user-inputTripDim2" name="inputTripDim2" [(ngModel)]="largeurTrip" placeholder="Largeur">
                      </div>
                      <div class="col-xl-4 text-xs-center">
                        <input type="text" class="form-control" id="user-inputTripDim3" name="inputTripDim3" [(ngModel)]="hauteurTrip" placeholder="Hauteur">
                      </div>
                    </div>
                  </div>
                  <br>
                  <div class="control-group">
                    <div class="row">
                      <div class="col-xl-4 text-xs-center">
                        <div class="form-group"><input type="text" class="form-control" id="user-inputTripPoids" name="inputTripPoids" [(ngModel)]="poidsTrip" placeholder="Poids"></div>
                      </div>
                    </div>
                  </div>
                </fieldset>
              </div>
            </div>
            <div class="form-group"><textarea class="form-control" id="user-inputTripDescription" name="inputTripDescription" [(ngModel)]="descriptionTrip" rows="3" placeholder="Description de colis"></textarea></div>
            <!-- <div class="form-group"><input type="text" class="form-control" id="user-inputTripDescription" name="inputTripDescription" [(ngModel)]="descriptionTrip" placeholder="Description de colis"></div> -->
            <!-- <div class="form-group">
                    <label for="user-InputImageTrip">Image de colis</label>
                    <input type="file" (change)="onUploadChange($event)" accept=".png, .jpg, .jpeg" class="form-control-file" id="user-InputImageTrip" [(ngModel)]="imgTrip" aria-describedby="fileHelp">
                    <img *ngFor="let ite of base64textString"  src={{ite}} alt="" id="user-img" style="width: 10%; height: 10%;">
                    <small id="user-fileHelp" class="form-text text-muted">Taille maximale d'image est 2Mo.</small>
            </div> -->

            <div class="form-group">
              <label for="user-InputImageTrip">Valeur de colis</label>
              <input type="text" class="form-control" id="user-inputTripValue" name="inputTripValue" [(ngModel)]="valueTrip" placeholder="exp: 58.60">
            </div>
            <div class="form-group">
              <h6><span>Choisir le mode de livraison:</span></h6>
              <select id="user-inputExpAdresseName" class="form-control" [(ngModel)]="modeLiv" (change)="getLatLngFromGov()">
                <!-- <option value="immediate">Immédiate</option> -->
                <option value="24H">24/48 heures</option>
              </select>
            </div>
            <div class="form-group">
              <h6><span>Choisir le type de paiement:</span></h6>
              <select id="user-inputExpAdresseName" class="form-control" [(ngModel)]="typePaiement" (change)="getLatLngFromGov()">
                <option  value="Payer par expéditeur">Payer par l'éxpéditeur</option>
                <option value="Payer par destinataire">Payer par le déstinataire</option>
                <option value="Contre remboursement">Contre remboursement</option>
              </select>
            </div>
            <div class="form-group">
              <button (click)="compressFile()">Image de colis</button>
              <small id="user-fileHelp" class="form-text text-muted">Taille maximale d'image est 2Mo.</small>
              <img *ngIf="imgResultBeforeCompress" [src]="imgResultBeforeCompress" alt="" style="display: none;">
              <img *ngIf="imgResultAfterCompress" [src]="imgResultAfterCompress" alt="" style="width: 10%; height: 10%;">
            </div>
          </div>
        </fieldset>
      </div>
    </div>
  </div>

  <div class="modal-footer">
    <button type="button" class="btn btn-secondary" (click)="c('Close click')">Fermer</button>
    <button type="button" class="btn btn-primary" (click)="addTrip()">Postuler</button>
  </div>
</ng-template>

<!-- <div id='modal_dialog'>
        <div class='title'>Etes-vous sur de bien vouloir supprimer cet élément ?</div>
        <input type='button' value='yes' id='btnYes' />
        <input type='button' value='no' id='btnNo' />
</div> -->

<ng-template #userContent6 let-modal>
  <div class="modal-header">
    <h4 class="modal-title" id="user-modal-basic-title">Génération de manifeste</h4>
    <button type="button" class="btn btn-primary" (click)="generateDechargeForAdmin();">Générer</button>
  </div>
  <div class="modal-body">
    <table class="table table-sm" id="user-contentToConvert" style="font-size:12px !important;">
      <thead class="thead">
      <tr style="border-style:hidden; border-width: 0px;">
        <th><img src="assets/images/l2.png" height="52" width="52"></th>
        <th colspan="1"><u>Société:</u>&nbsp;<b>PACKWAYS</b></th>
        <th colspan="3" class="text-center" align="left" valign="top"><h3>BON DE SORTIE N°{{entier}}</h3></th>
      </tr>
      <tr style="border-style:hidden; border-width: 0px;">
        <th colspan="1"></th>
        <th colspan="5"><u>MF:</u>&nbsp;<b>1612403CAM000</b> &nbsp; <u>Date:</u> {{dateJ}}&nbsp;&nbsp;&nbsp; <u>Livreur:</u>
          &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
          &nbsp;&nbsp;&nbsp;&nbsp; <u>Mat_Voiture:</u><!-- Date:&nbsp;{{dateJ}} --></th>
        <th colspan="5" class="text-right"><u>Total des colis:</u>&nbsp;{{totalTripInManifest}}</th>
      </tr>
      <tr class="thead-light text-center">
        <th style="width:7%">Ref</th>
        <th style="width:10%">Déstinataire</th>
        <th *ngIf="!isVisible" style="width:10%">Téléphone</th>
        <th style="width:50%">Adresse</th>
        <th style="width:30%">Description</th>
        <th style="width:1%">Val</th>
      </tr>
      </thead>
      <tbody style="font-size:14px !important;">
      <tr *ngFor="let trp of checkedTrips" class="table-active text-center" style="background-color: #ffffff;">
        <td style="background-color: #ffffff;">{{trp.refTrip}}</td><td *ngIf="!isVisible" style="background-color: #ffffff;">{{trp.destTrip.contactAdr}}</td>
        <td *ngIf="!isVisible" style="background-color: #ffffff;">{{trp.destTrip.mobileAdr}}</td>
        <td style="background-color: #ffffff;">{{trp.destTrip.cityAdr}}</td>
        <td style="background-color: #ffffff;">{{trp.descriptionTrip}}</td>
        <td style="background-color: #ffffff;">{{trp.packageTrip.valPackage }}</td>

      </tr>
      </tbody>
      <tfoot>
      <tr style="background-color: #e9ecef;">
        <td colspan="8"><b>Fraix total:</b> {{fraixTotal}} &nbsp;&nbsp; <b>Valeur total:</b> {{valeurTotal}}</td>
      </tr>
      </tfoot>
    </table>
  </div>
  <div class="modal-footer">
    <button type="button" class="btn btn-secondary" (click)="modal.close('Save click')">Fermer</button>
  </div>
</ng-template>

<ng-template #userContent8 let-modal>
  <div class="modal-header">
    <h4 class="modal-title" id="user-modal-basic-title">Génération de décharge</h4>
    <button type="button" class="btn btn-primary" (click)="generateDechargeForClient()">Générer</button>
  </div>
  <div class="modal-body">
    <table class="table table-sm" id="user-contentToConvert" style="font-size:10px !important;">
      <thead class="thead-dark">
      <tr class="text-center">
        <th style="width:10%">Ref</th>
        <th style="width:15%">Déstinataire</th>
        <th style="width:15%">Téléphone</th>
        <th style="width:40%">Adresse</th>
        <th style="width:25%">Date création</th>
        <th style="width:15%">Frais</th>
        <th style="width:15%">Valeur</th>
      </tr>
      </thead>
      <tbody>
      <tr *ngFor="let trp of checkedTrips" class="table-active text-center" style="background-color: #ffffff;">
        <td style="background-color: #ffffff;">{{trp.refTrip}}</td>
        <td style="background-color: #ffffff;">{{trp.destTrip.contactAdr}}</td>
        <td style="background-color: #ffffff;">{{trp.destTrip.mobileAdr}}</td>
        <td style="background-color: #ffffff;">{{trp.destTrip.cityAdr}}</td>
        <td style="background-color: #ffffff;">{{changeDateFormat(trp.createdday)}}</td>
        <td style="background-color: #ffffff;">{{trp.costTrip }}</td>
        <td style="background-color: #ffffff;">{{trp.packageTrip.valPackage }}</td>
      </tr>
      </tbody>
      <tfoot>
      <tr class="table-primary">
        <td colspan="7">Fraix total: {{fraixTotal}}</td>
      </tr>
      <tr class="table-primary">
        <td colspan="7">Valeur total: {{valeurTotal}}</td>
      </tr>
      </tfoot>
    </table>
  </div>
  <div class="modal-footer">
    <button type="button" class="btn btn-secondary" (click)="modal.close('Save click')">Fermer</button>
  </div>
</ng-template>

<ng-template #userContent7 let-modal id="user-content7">
  <div class="modal-header">
    <h4 class="modal-title">Le bon de livraison de colis &nbsp; {{tripBl.refTrip}} &nbsp; a été envoyé avec succès.</h4>
    <button type="button" class="close" aria-label="Close" (click)="modal.close('Save click')">
      <span aria-hidden="true">&times;</span>
    </button>
  </div>

  <div class="modal-footer">
    <button type="button" class="btn btn-secondary" (click)="modal.close('Save click')">Fermer</button>
  </div>
</ng-template>

<ng-template #userContentMsg let-modal id="user-contentMsg">
  <div class="modal-header">
    <h5 class="modal-title">Envoyer un message au client:&nbsp; {{trpMsg.userTrip.nameUser}}.&nbsp;Référence de colis:&nbsp; {{trpMsg.refTrip}}.</h5>
    <button type="button" class="close" aria-label="Close" (click)="modal.close('Save click')">
      <span aria-hidden="true">&times;</span>
    </button>
  </div>
  <div class="modal-body">
    <div class="row">
      <div class="col-xl-12 text-xs-center">
        <fieldset class="scheduler-border">
          <legend class="scheduler-border">Sélectionner un message:</legend>
          <div class="control-group">
            <div class="form-group">
              <select id="user-inputPreMessageToClient" class="form-control dropdown-class" [(ngModel)]="inputPreMessageToClient">
                <option *ngFor="let message of PreMessages" [ngValue]="message">
                  {{ message }}
                </option>
              </select>
            </div>
            <div class="form-group"><input type="text" class="form-control" id="user-inputCusMessageToClient" name="inputCusMessageToClient" [(ngModel)]="inputCusMessageToClient" placeholder="Message personalisé"></div>
          </div>
        </fieldset>
      </div>
    </div>
  </div>
  <div class="modal-footer">
    <button type="button" class="btn btn-danger" (click)="modal.close('Save click')">Annuler</button>
    <button type="button" class="btn btn-primary" (click)="onClickPreMsg(); modal.close('Save click');">Envoyer</button>
  </div>
</ng-template>

<ng-template #userContentMsgAction let-modal id="user-contentMsgAction">
  <div class="modal-header">
    <h5 class="modal-title">Envoyer un message multiple</h5>
    <button type="button" class="close" aria-label="Close" (click)="modal.close('Save click')">
      <span aria-hidden="true">&times;</span>
    </button>
  </div>
  <div class="modal-body">
    <div class="row">
      <div class="col-xl-12 text-xs-center">
        <fieldset class="scheduler-border">
          <legend class="scheduler-border">Sélectionner un message:</legend>
          <div class="control-group">
            <div class="form-group">
              <select id="user-inputPreMessageToClient" class="form-control dropdown-class" [(ngModel)]="inputPreMessageToClient">
                <option *ngFor="let message of PreMessagesAction" [ngValue]="message">
                  {{ message }}
                </option>
              </select>
            </div>
            <div class="form-group"><input type="text" class="form-control" id="user-inputCusMessageToClient" name="inputCusMessageToClient" [(ngModel)]="inputCusMessageToClient" placeholder="Message personalisé"></div>
          </div>
        </fieldset>
      </div>
    </div>
  </div>
  <div class="modal-footer">
    <button type="button" class="btn btn-danger" (click)="modal.close('Save click')">Annuler</button>
    <button type="button" class="btn btn-primary" (click)="actionSendSms(); modal.close('Save click');">Envoyer</button>
  </div>
</ng-template>

<ng-template #userContentBl let-modal>
  <div class="modal-header">
    <h4 class="modal-title" id="user-modal-basic-title">Génération de bon de livraison de colis: {{tripBl.refTrip}}</h4>
    <button type="button" class="btn btn-primary" (click)="generateBLivraison()">Générer</button>
  </div>
  <div class="modal-body">
    <table id="user-contentBlToConvert" class="table table-borderless-cus" background="assets/images/stickers.png"  style="border-collapse: unset;background-position:center; background-repeat: no-repeat; border-style:groove; border-width: 5px;
                border-color:rgb(0, 0, 0);" >
      <tbody style="padding-top: .0em; padding-bottom: .0em;">
      <tr class="text-center">
        <td><b>Cachet et signature</b></td>
        <td colspan="3"><h2><u>BON DE LIVRAISON</u></h2><br><H2>N°{{numBl}}</H2></td>
        <td><ngx-qrcode
          [qrc-value] = "tripBl.idTrip"
          qrc-class = "aclass" qrc-version = "2"
          qrc-errorCorrectionLevel = "L"
        >
        </ngx-qrcode>
        </td>
      </tr>
      <tr>
        <td class="text-left"><b>REF</b></td>
        <td colspan="3"><b>{{tripBl.refTrip}}</b></td>
        <td class="text-center"><b>Date</b> <br> {{changeDateFormat(tripBl.createdday)}} </td>
        <!-- <td colspan="2" class="text-left"><h3>Code expéditeur</h3></td>
        <td>{{tripBl.codeExp}}</td> -->
      </tr>
      <tr height="70" style="border-style:solid; border-width: 2px;">
        <td class="text-left" ><b>Expéditeur</b></td>
        <td colspan="2">{{tripBl.userTrip.nameUser}}</td>
        <td class="text-left"><b>Mobile</b></td>
        <td>{{tripBl.userTrip.mobileUser}}</td>
      </tr>
      <tr>
        <td class="text-left"><b>Adresse</b></td>
        <td colspan="4">{{tripBl.sourceTrip.cityAdr}}</td>
      </tr>
      <tr>
        <td class="text-left"><b>Déstinataire</b></td>
        <td colspan="2">{{tripBl.destTrip.contactAdr}}</td>
        <td class="text-left"><b>Mobile</b></td>
        <td>{{tripBl.destTrip.mobileAdr}}</td>
      </tr>
      <tr>
        <td class="text-left"><b>Adresse</b></td>
        <td colspan="4">{{tripBl.destTrip.labelAdr}}&nbsp;{{tripBl.destTrip.cityAdr}}</td>
      </tr>
      <tr>
        <td colspan="2"><b>Prix Total(HT)</b>&nbsp;&nbsp; {{valHt}}</td>
        <td colspan="2"><b>TVA</b> &nbsp; &nbsp; 19%</td>
        <td colspan="2" class="text-left"><b>ValeurTTC </b>&nbsp; &nbsp; {{tripBl.packageTrip.valPackage}}</td>
      </tr>
      <tr>
        <td class="text-left"><b>Description</b></td>
        <td colspan="4">{{tripBl.descriptionTrip}}</td>
      </tr>
      <!--
      <tr height="70" style="border-style:solid; border-width: 2px;">
              <td colspan="2"><b>Cachet et signature</b></td>
              <td class="text-center"><b>Date</b> <br> {{changeDateFormat(tripBl.createdday)}} </td>
              <td colspan="2"><b>Nom de livreur et matricule de voiture</b></td>
      </tr>
      -->
      <tr height="2" style="border-style:solid; border-width: 2px;">
        <td><b>Tel:</b> +21654885552</td>
        <td colspan="3"><b>Email:</b> contact.packways@gmail.com</td>
        <td><b>Facebook:</b> Packways</td>
      </tr>
      </tbody>
      <!--Table body-->
    </table>
  </div>
  <div class="modal-footer">
    <button type="button" class="btn btn-secondary" (click)="modal.close('Save click');">Fermer</button>
  </div>
</ng-template>

<ng-template #userContentImport let-modal id="user-contentImport">
  <div class="modal-header">
    <!-- <h5 class="modal-title">Importation des colis à partir d'un fichier excel.</h5> <br> -->
    <div class="row">
      <div class="col-xl-12 text-xs-center">
        <div class="form-group">
          <small class="form-text text-primary" style="font-size:10px !important;">Choisissez une adresse source déjà enregistrée.</small>
          <select id="user-inputExpAdresseNameExcel" class="form-control" [(ngModel)]="selectedAdresseExpExcel" (change)="tripsFromExcelAdrLatLng()">
            <option *ngFor="let adresse of Adresses" [ngValue]="adresse">
              {{ adresse.labelAdr }}
            </option>
          </select>
        </div>
      </div>
    </div>
  </div>
  <div class="modal-body" hidden>
    <table class="table table-sm" style="background-color: #ffffff;">
      <tbody style="background-color: #ece8e8;">
      <tr *ngFor="let row of tripsFromExcelTemp" class="table-active text-center">
        <td *ngFor="let val of row">
          {{val}}
        </td>
      </tr>
      </tbody>
    </table>
  </div>

  <div class="modal-footer">
    <button type="button" class="btn btn-secondary btn-sm" (click)="modal.close('Save click')">Annuler</button>  <!-- showArrayTrip() -->
    <button type="button" class="btn btn-primary btn-sm" (click)="addTripsFromExcelFile();modal.close('Save click');">Confirmer</button>
  </div>

</ng-template>

<ng-template #userContentupdateargentR let-c="close" let-d="dismiss">
  <div class="modal-body">
    <div class="row">
      <h6>Etes-vous sur de bien vouloir recolter le colis REF: {{tripBl.refTrip}} ?</h6>
    </div>
  </div>
  <div class="modal-footer">
    <button type="button" class="btn btn-danger" (click)="(c('Close click'))">Annuler</button>
    <button type="button" class="btn btn-primary" (click)="updateArgentRecolte();(c('Close click'))">Confirmer</button>
  </div>
</ng-template>

<ng-template #userContentupdateargentRL let-c="close" let-d="dismiss">
  <div class="modal-body">
    <div class="row justify-content-center">
      <h6 style="color: #f00f0f;"><b>Etes-vous sur de bien vouloir recolter ces colis ?</b></h6>
    </div>
  </div>
  <div class="modal-body">
    <table class="table table-sm" id="user-contentToConvert" style="font-size:12px !important;">
      <thead class="thead">
      <tr class="thead-light text-center">
        <th style="width:1%">Ref</th>
        <th style="width:1%">Valeur</th>
        <th style="width:1%">Action</th>
      </tr>
      </thead>
      <tbody style="font-size:14px !important;">
      <tr *ngFor="let trp of checkedTrips" class="table-active text-center" style="background-color: #ffffff;">
        <td style="background-color: #ffffff;">{{trp.refTrip}}</td>
        <td style="background-color: #ffffff;">{{trp.packageTrip.valPackage }}</td>
        <td style="background-color: #ffffff;">
          <i class="material-icons" (click)="deleteChecked(trp)" > delete </i>
        </td>

      </tr>
      </tbody>
      <tfoot>
      <tr>
        <td><h6><b> Total:  </b></h6></td>
        <td><h6><b> {{sommeTotal}} </b></h6></td>
      </tr>
      </tfoot>
    </table>
  </div>
  <div class="modal-footer">
    <button type="button" class="btn btn-danger" (click)="(c('Close click'))">Annuler</button>
    <button type="button" class="btn btn-primary" (click)="recolterTrip();(c('Close click'))">Confirmer</button>
  </div>
</ng-template>

<ng-template #userContentupdatePresRecolte let-c="close" let-d="dismiss">
  <div class="modal-body">
    <div class="row justify-content-center">
      <h6 style="color: #f00f0f;"><b>Etes-vous sur de bien vouloir Prés recolter ces colis ?</b></h6>
    </div>
  </div>
  <div class="modal-body">
    <table class="table table-sm" id="user-contentToConvert" style="font-size:12px !important;">
      <thead class="thead">
      <tr class="thead-light text-center">
        <th style="width:1%">Ref</th>
        <th style="width:1%">Valeur</th>
        <th style="width:1%">Action</th>
      </tr>
      </thead>
      <tbody style="font-size:14px !important;">
      <tr *ngFor="let trp of checkedTrips" class="table-active text-center" style="background-color: #ffffff;">
        <td style="background-color: #ffffff;">{{trp.refTrip}}</td>
        <td style="background-color: #ffffff;">{{trp.packageTrip.valPackage }}</td>
        <td style="background-color: #ffffff;">
          <i class="material-icons" (click)="deleteChecked(trp)" > delete </i>
        </td>

      </tr>
      </tbody>
      <tfoot>
      <tr>
        <td><h6><b> Total:  </b></h6></td>
        <td><h6><b> {{sommeTotal}} </b></h6></td>
      </tr>
      </tfoot>
    </table>
  </div>
  <div class="modal-footer">
    <button type="button" class="btn btn-danger" (click)="(c('Close click'))">Annuler</button>
    <button type="button" class="btn btn-primary" (click)="PresrecolterTrip();(c('Close click'))">Confirmer</button>
  </div>
</ng-template>

<ng-template #userContentupdateCloture let-c="close" let-d="dismiss">
  <div class="modal-body">
    <div class="row justify-content-center">
      <h6 style="color: #f01010;"><b>Etes-vous sur de bien vouloir cloturer ces colis ?</b></h6>
    </div>
  </div>
  <div class="modal-body">
    <table class="table table-sm" id="user-contentToConvert" style="font-size:12px !important;">
      <thead class="thead">
      <tr class="thead-light text-center">
        <th style="width:1%">Ref</th>
        <th style="width:1%">Valeur</th>
        <th style="width:1%">Action</th>
      </tr>
      </thead>
      <tbody style="font-size:14px !important;">
      <tr *ngFor="let trp of checkedTrips" class="table-active text-center" style="background-color: #ffffff;">
        <td style="background-color: #ffffff;">{{trp.refTrip}}</td>
        <td style="background-color: #ffffff;">{{trp.packageTrip.valPackage }}</td>
        <td style="background-color: #ffffff;">
          <i class="material-icons" (click)="deleteChecked(trp)" > delete </i>
        </td>

      </tr>
      </tbody>
      <tfoot>
      <tr>
        <td><h6><b> Total:  </b></h6></td>
        <td><h6><b> {{sommeTotal}} </b></h6></td>
      </tr>
      </tfoot>
    </table>
  </div>
  <div class="modal-footer">
    <button type="button" class="btn btn-danger" (click)="(c('Close click'))">Annuler</button>
    <button type="button" class="btn btn-primary" (click)="closeTrip();(c('Close click'))">Confirmer</button>
  </div>
</ng-template>

<ng-template #userContentupdatePayment let-c="close" let-d="dismiss">
  <div class="modal-body">
    <div class="row justify-content-center">
      <h6 style="color: #f01010;"><b>Etes-vous sur de bien vouloir lancer le payment de ces colis ?</b></h6>
    </div>
  </div>
  <div class="modal-body">
    <table class="table table-sm" id="user-contentToConvert" style="font-size:12px !important;">
      <thead class="thead">
      <tr class="thead-light text-center">
        <th style="width:1%">Ref</th>
        <th style="width:1%">Valeur</th>
        <th style="width:1%">Action</th>
      </tr>
      </thead>
      <tbody style="font-size:14px !important;">
      <tr *ngFor="let trp of checkedTrips" class="table-active text-center" style="background-color: #ffffff;">
        <td style="background-color: #ffffff;">{{trp.refTrip}}</td>
        <td style="background-color: #ffffff;">{{trp.packageTrip.valPackage }}</td>
        <td style="background-color: #ffffff;">
          <i class="material-icons" (click)="deleteChecked(trp)" > delete </i>
        </td>
      </tr>
      </tbody>
      <tfoot>
      <tr>
        <td><h6><b> Total:  </b></h6></td>
        <td><h6><b> {{sommeTotal}} </b></h6></td>
      </tr>
      </tfoot>
    </table>
  </div>
  <div class="modal-footer">
    <button type="button" class="btn btn-danger" (click)="(c('Close click'))">Annuler</button>
    <button type="button" class="btn btn-primary" (click)="EncoursPayementTrip();(c('Close click'))">Confirmer</button>
  </div>
</ng-template>

<ng-template #userContentupdatecout let-c="close" let-d="dismiss">
  <div class="modal-body">
    <div class="row justify-content-center">
      <h6 style="color: #f01010;"><b>Etes-vous sur de bien vouloir changer le coùt de ces colis ?</b></h6>
    </div>
  </div>
  <div class="modal-body">
    <table class="table table-sm" id="user-contentToConvert" style="font-size:12px !important;">
      <thead class="thead">
      <tr class="thead-light text-center">
        <th style="width:1%">Ref</th>
        <th style="width:1%">Valeur</th>
        <th style="width:1%">Action</th>
      </tr>
      </thead>
      <tbody style="font-size:14px !important;">
      <tr *ngFor="let trp of checkedTrips" class="table-active text-center" style="background-color: #ffffff;">
        <td style="background-color: #ffffff;">{{trp.refTrip}}</td>
        <td style="background-color: #ffffff;">{{trp.packageTrip.valPackage }}</td>
        <td style="background-color: #ffffff;">
          <i class="material-icons" (click)="deleteChecked(trp)" > delete </i>
        </td>
      </tr>
      </tbody>
      <tfoot>
      <tr>
        <td><h6><b> Total:  </b></h6></td>
        <td><h6><b> {{sommeTotal}} </b></h6></td>
      </tr>
      </tfoot>
    </table>
  </div>
  <div class="modal-footer">
    <button type="button" class="btn btn-danger" (click)="(c('Close click'))">Annuler</button>
    <button type="button" class="btn btn-primary" (click)="changerCout();(c('Close click'))">Confirmer</button>
  </div>
</ng-template>


<ng-template #userContentupdateStatus let-c="close" let-d="dismiss">
  <div class="modal-body">
    <div class="row justify-content-center">
      <h6 style="color: #f01010;"><b>Etes-vous sur de bien vouloir changer le statut de ces colis ?</b></h6>
    </div>
  </div>
  <div class="modal-body">
    <table class="table table-sm" id="user-contentToConvert" style="font-size:12px !important;">
      <thead class="thead">
      <tr class="thead-light text-center">
        <th style="width:1%">Ref</th>
        <th style="width:1%">Status</th>
        <th style="width:1%">Action</th>
      </tr>
      </thead>
      <tbody style="font-size:14px !important;">
      <tr *ngFor="let trp of checkedTrips" class="table-active text-center" style="background-color: #ffffff;">
        <td style="background-color: #ffffff;">{{trp.refTrip}}</td>
        <td style="background-color: #ffffff;">{{trp.statusTrip }}</td>
        <td style="background-color: #ffffff;">
          <i class="material-icons" (click)="deleteChecked(trp)" > delete </i>
        </td>
      </tr>
      </tbody>
    </table>
  </div>
  <div class="modal-footer">
    <button type="button" class="btn btn-danger" (click)="(c('Close click'))">Annuler</button>
    <button type="button" class="btn btn-primary" (click)="actionEtat();(c('Close click'))">Confirmer</button>
  </div>
</ng-template>

<ng-template #userContentupdatedriverAFF let-c="close" let-d="dismiss">
  <div class="modal-body">
    <div class="row justify-content-center">
      <h6 style="color: #f01010;"><b>Etes-vous sur de bien vouloir affecter le condicteur " {{actionA.nameDriver}} {{actionA.surnameDriver}} " à ces colis ?</b></h6>
    </div>
  </div>
  <div class="modal-body">
    <table class="table table-sm" id="user-contentToConvert" style="font-size:12px !important;">
      <thead class="thead">
      <tr class="thead-light text-center">
        <th style="width:1%">Ref</th>
        <th style="width:1%">Driver</th>
        <th style="width:1%">Action</th>
      </tr>
      </thead>
      <tbody style="font-size:14px !important;">
      <tr *ngFor="let trp of checkedTrips" class="table-active text-center" style="background-color: #ffffff;">
        <td style="background-color: #ffffff;">{{trp.refTrip}}</td>
        <td style="background-color: #ffffff;" *ngIf="trp.driverTrip!==null">{{trp.driverTrip.nameDriver }} {{trp.driverTrip.surnameDriver }}</td>
        <td style="background-color: #ffffff;" *ngIf="trp.driverTrip===null">Aucun livreur</td>
        <td style="background-color: #ffffff;">
          <i class="material-icons" (click)="deleteChecked(trp)" > delete </i>
        </td>
      </tr>
      </tbody>
    </table>
  </div>
  <div class="modal-footer">
    <button type="button" class="btn btn-danger" (click)="(c('Close click'))">Annuler</button>
    <button type="button" class="btn btn-primary" (click)="actionAffectation();(c('Close click'))">Confirmer</button>
  </div>
</ng-template>

<ng-template #userContentexport let-c="close" let-d="dismiss">
  <div class="modal-body">
    <div class="row justify-content-center">
      <h6 style="color: #f01010;"><b>Etes-vous sur de bien vouloir exporter ces colis ?</b></h6>
    </div>
  </div>
  <div class="modal-body">
    <table class="table table-sm" id="user-contentToConvert" style="font-size:12px !important;">
      <thead class="thead">
      <tr class="thead-light text-center">
        <th style="width:1%">Ref</th>
        <th style="width:1%">Destinataire</th>
      </tr>
      </thead>
      <tbody style="font-size:14px !important;">
      <tr *ngFor="let trp of checkedTrips" class="table-active text-center" style="background-color: #ffffff;">
        <td style="background-color: #ffffff;">{{trp.refTrip}}</td>
        <td style="background-color: #ffffff;" >{{trp.destTrip.contactAdr }}</td>
      </tr>
      </tbody>
    </table>
  </div>
  <div class="modal-footer">
    <button type="button" class="btn btn-danger" (click)="(c('Close click'))">Annuler</button>
    <button type="button" class="btn btn-primary" (click)="generatePackwaysExcelReport();(c('Close click'))">Confirmer</button>
  </div>
</ng-template>

<ng-template #userContentdeleteTrip let-c="close" let-d="dismiss">
  <div class="modal-body">
    <div class="row">
      <h6>Etes-vous sur de bien vouloir supprimer le colis REF: {{tripBl.refTrip}} ?</h6>
    </div>
  </div>
  <div class="modal-footer">
    <button type="button" class="btn btn-danger" (click)="(c('Close click'))">Annuler</button>
    <button type="button" class="btn btn-primary" (click)="deleteTrip(tripBl);(c('Close click'))">Confirmer</button>
  </div>
</ng-template>

<ng-template #userContentHostorique let-c="close" let-d="dismiss">
  <div class="modal-header">
    <h4 class="modal-title">Historique de trip:&nbsp; {{objTrip.refTrip}} </h4>
    <button type="button" class="close" aria-label="Close" (click)="d('Cross click')">
      <span aria-hidden="true">&times;</span>
    </button>
  </div>
  <div class="row">
    <div class="col-xl-12 text-xs-center" *ngIf="objTrip.historique && objTrip.historique.length > 0">
      <fieldset class="scheduler-border">
        <legend class="scheduler-border"><h6>Historique</h6></legend>
        <div class="control-group">
          <ul *ngFor="let his of objTrip.historique">
            <li>{{his.ws}}
              <ul>
                <li>{{his.action}}</li>
                <li>{{his.changedRecord}}</li>
                <li>{{changeDateFormat(his.dateRecord)}}</li>
              </ul>
            </li>
          </ul>
        </div>
      </fieldset>
    </div>
  </div>

  <div class="modal-footer">
    <button type="button" class="btn btn-danger" (click)="c('Close click')">Fermer</button>
  </div>
</ng-template>

<ng-template #userContentscandochette let-c="close" let-d="dismiss">
  <div class="modal-body">
    <div class="row justify-content-center">
      <div class="col-xl-4 text-xs-center">
        <!-- <form class="form-inline my-2 my-lg-0">
                <input class="form-control mr-sm-2" type="text" id="user-myInput" placeholder="Chercher" [(ngModel)]="searchTerm" [ngModelOptions]="{standalone: true}" (select)="setFilteredItems()">
        </form> -->
        <fieldset class="scheduler-border-1">
          <legend class="scheduler-border-1">Scan QR-Code</legend>
          <form class="form-inline mr-auto">
            <input class="form-control" type="text" id="user-myInput" [(ngModel)]="searchTermscan" [ngModelOptions]="{standalone: true}" placeholder="Chercher" aria-label="Search" width="100%">
            <button class="btn btn-mdb-color btn-rounded btn-sm my-0 ml-sm-2" (click)="scanList()" type="submit" hidden><i class="fa fa-search"></i></button>
          </form>
        </fieldset>
      </div>
    </div>
    <small class="form-text text-primary" style="font-size:12px !important;">Nombre des colis selectionnées:  <b>{{ListScanNB}}</b></small>
    <table class="table table-sm" id="user-contentToConvert" style="font-size:12px !important;">
      <thead class="thead"  *ngIf="ListScan !== []" >
      <tr class="thead-light text-center">
        <th style="width:1%">Ref</th>
        <th style="width:1%">Status</th>
        <th style="width:1%">Expéditeur</th>
        <th style="width:1%">Destinataire</th>
        <th style="width:1%">Msg</th>
        <th style="width:1%">Action</th>

      </tr>
      </thead>
      <tbody style="font-size:14px !important;">
      <tr *ngFor="let trp of ListScan" class="table-active text-center" style="background-color: #ffffff;">
        <td style="background-color: #ffffff;">{{trp.refTrip}}</td>
        <td style="background-color: #ffffff; width:15%;">{{trp.statusTrip}}</td>
        <td style="background-color: #ffffff; width:15%;">{{trp.userTrip.nameUser}} {{trp.userTrip.surnameUser}}</td>
        <td style="background-color: #ffffff; width:15%;" >{{trp.destTrip.contactAdr }}</td>
        <td  style="background-color: #ffffff;  width:50%;" *ngIf="trp.msgTrip && trp.msgTrip.length > 0">
          <ul>
            <li>{{trp.msgTrip[trp.msgTrip.length-1].contentMsg }}</li>
            <li>{{trp.msgTrip[trp.msgTrip.length-1].dateMsg }}</li>
          </ul>
        </td>
        <td style="background-color: #ffffff;" *ngIf="trp.msgTrip && trp.msgTrip.length === 0">-</td>
        <td style="background-color: #ffffff;">
          <i class="material-icons" (click)="deleteScanList(trp)" > delete </i>
        </td>
      </tr>
      </tbody>
    </table>

  </div>
  <div class="modal-footer">
    <button type="button" class="btn btn-danger" (click)="(c('Close click'))">Annuler</button>
    <button type="button" class="btn btn-primary" (click)="chercher();(c('Close click'))">Chercher</button>
  </div>
</ng-template>

<ng-template #userContentBS let-c="close" let-d="dismiss">
  <div class="modal-body">
    <div class="row" layout-align="center center" >
      <h4>Choisir le livreur</h4>
    </div>
    <ng2-completer [inputClass]="'form-control form-control-inline'" [datasource]="Listdriverauto" [minSearchLength]="0" [textSearching]="'Cherche...'"
                   [textNoResults]="'Pas trouvé.'" [placeholder]="'Entrer le livreur'" id="user-driverFilter" name="driverFilter" [(ngModel)]="driverFilter"
                   (selected)="getSelectedDriver($event)">
    </ng2-completer>
  </div>
  <div class="modal-footer">
    <button type="button" class="btn btn-danger" (click)="(c('Close click'))">Annuler</button>
    <button type="button" class="btn btn-primary" (click)="BSFromServer(userContentBSTelechargement);(c('Close click'))">Suivant</button>
  </div>
</ng-template>

<ng-template #userContentBSTelechargement let-c="close" let-d="dismiss">
  <div class="modal-body">
    <div class="row" layout-align="center center" >
      <h4>Telechargement</h4>
    </div>

  </div>
  <div class="modal-footer">
    <button type="button" class="btn btn-danger" (click)="(c('Close click'))">Annuler</button>
    <button type="button" class="btn btn-primary" (click)="downloadBS();(c('Close click'))">Download</button>
  </div>
</ng-template>


<ng-template #userContentRC let-c="close" let-d="dismiss">
  <div class="modal-body">
    <div class="row" layout-align="center center" >
      <h4>Recu de Colis</h4>
    </div>
    <!-- <ng2-completer [inputClass]="'form-control form-control-inline'" [datasource]="Listdriverauto" [minSearchLength]="0" [textSearching]="'Cherche...'"
        [textNoResults]="'Pas trouvé.'" [placeholder]="'Entrer le livreur'" id="user-driverFilter" name="driverFilter" [(ngModel)]="driverFilter"
        (selected)="getSelectedDriver($event)">
    </ng2-completer> -->
  </div>
  <div class="modal-footer">
    <button type="button" class="btn btn-danger" (click)="(c('Close click'))">Annuler</button>
    <button type="button" class="btn btn-primary" (click)="RCFromServer(userContentRCTelechargement);(c('Close click'))">Suivant</button>
  </div>
</ng-template>

<ng-template #userContentRCTelechargement let-c="close" let-d="dismiss">
  <div class="modal-body">
    <div class="row" layout-align="center center" >
      <h4>Telechargement</h4>
    </div>

  </div>
  <div class="modal-footer">
    <button type="button" class="btn btn-danger" (click)="(c('Close click'))">Annuler</button>
    <button type="button" class="btn btn-primary" (click)="downloadRC();(c('Close click'))">Download</button>
  </div>
</ng-template>

<ng-template #userContentBL let-c="close" let-d="dismiss">
  <div class="modal-body">
    <div class="row" layout-align="center center" >
      <h4>Bon De Livraison</h4>
    </div>
    <!-- <ng2-completer [inputClass]="'form-control form-con
      trol-inline'" [datasource]="Listdriverauto" [minSearchLength]="0" [textSearching]="'Cherche...'"
        [textNoResults]="'Pas trouvé.'" [placeholder]="'Entrer le livreur'" id="user-driverFilter" name="driverFilter" [(ngModel)]="driverFilter"
        (selected)="getSelectedDriver($event)">
    </ng2-completer> -->
  </div>
  <div class="modal-footer">
    <button type="button" class="btn btn-danger" (click)="(c('Close click'))">Annuler</button>
    <button type="button" class="btn btn-primary" (click)="BLFromServer(userContentBLTelechargement);(c('Close click'))">Suivant</button>
  </div>
</ng-template>

<ng-template #userContentRapport let-c="close" let-d="dismiss">
  <div class="modal-body">
    <div class="row" layout-align="center center" >
      <h4>Rapport De Livraison</h4>
    </div>
    <!-- <ng2-completer [inputClass]="'form-control form-control-inline'" [datasource]="Listdriverauto" [minSearchLength]="0" [textSearching]="'Cherche...'"
        [textNoResults]="'Pas trouvé.'" [placeholder]="'Entrer le livreur'" id="user-driverFilter" name="driverFilter" [(ngModel)]="driverFilter"
        (selected)="getSelectedDriver($event)">
    </ng2-completer> -->
  </div>
  <div class="modal-footer">
    <button type="button" class="btn btn-danger" (click)="(c('Close click'))">Annuler</button>
    <button type="button" class="btn btn-primary" (click)="RapportLivFromServer(userContentRapportTelechargement);(c('Close click'))">Suivant</button>
  </div>
</ng-template>

<ng-template #userContentBLTelechargement let-c="close" let-d="dismiss">
  <div class="modal-body">
    <div class="row" layout-align="center center" >
      <h4>Telechargement</h4>
    </div>

  </div>
  <div class="modal-footer">
    <button type="button" class="btn btn-danger" (click)="(c('Close click'))">Annuler</button>
    <button type="button" class="btn btn-primary" (click)="downloadBL();(c('Close click'))">Download</button>
  </div>
</ng-template>

<ng-template #userContentBRetour let-c="close" let-d="dismiss">
  <div class="modal-body">
    <div class="row" layout-align="center center" >
      <h4>Bon De Retour</h4>
    </div>
    <ng2-completer [inputClass]="'form-control form-control-inline'" [datasource]="Listdriverauto" [minSearchLength]="0" [textSearching]="'Cherche...'"
                   [textNoResults]="'Pas trouvé.'" [placeholder]="'Entrer le livreur'" id="user-driverFilter" name="driverFilter" [(ngModel)]="driverFilter"
                   (selected)="getSelectedDriver($event)">
    </ng2-completer>
  </div>
  <div class="modal-footer">
    <button type="button" class="btn btn-danger" (click)="(c('Close click'))">Annuler</button>
    <button type="button" class="btn btn-primary" (click)="BRetourFromServer(userContentBRetourTelechargement);(c('Close click'))">Suivant</button>
  </div>
</ng-template>

<ng-template #userContentBRetourTelechargement let-c="close" let-d="dismiss">
  <div class="modal-body">
    <div class="row" layout-align="center center" >
      <h4>Telechargement</h4>
    </div>

  </div>
  <div class="modal-footer">
    <button type="button" class="btn btn-danger" (click)="(c('Close click'))">Annuler</button>
    <button type="button" class="btn btn-primary" (click)="downloadBRetour();(c('Close click'))">Download</button>
  </div>
</ng-template>

<ng-template #userContentRapportTelechargement let-c="close" let-d="dismiss">
  <div class="modal-body">
    <div class="row" layout-align="center center" >
      <h4>Telechargement</h4>
    </div>

  </div>
  <div class="modal-footer">
    <button type="button" class="btn btn-danger" (click)="(c('Close click'))">Annuler</button>
    <button type="button" class="btn btn-primary" (click)="downloadRapport();(c('Close click'))">Download</button>
  </div>
</ng-template>

